c --- Routines taken from NT, hep-ph/9806317

c --- Throughout this file the flavor ordering
c     
c     1 - q, 2 - qb, 3 - Q, 4 - Qb, 5 - g, 6 - e+, 7 - e-
c     
c     is always used! 

      REAL(KIND(1D0)) FUNCTION M_2q2Q1g_tree(ONE,TWO,THREE,FOUR,FIVE
     $     ,SIX,SEVEN,TYPE1,TYPE2)
      use QCDparams

      IMPLICIT NONE

      INTEGER ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,TYPE1,TYPE2,IHELE
      REAL(KIND(1D0)) PSI
      COMPLEX(KIND(1D0)) TEMP1,TEMP2,TEMP3,TEMP4,TEMP
      COMPLEX(KIND(1D0)) C1,C2,M1b1234,M1b3412,M2b1234,M2b3412
      REAL(KIND(1D0)) M_0,M_x,M_y,M_z,M_xx,M_xy
      REAL(KIND(1D0)) AA,DD,FF,GG

      REAL(KIND(1D0)) XNf,XNu,XNd,XNc,XNa,XNc2
      REAL(KIND(1D0)) Xnx,Xny,Xnz,XC3
      COMPLEX(KIND(1D0)) C(2,2,2)
      COMMON /COUPLINGS/ C
     >       /QCD/XNf,XNu,XNd,XNc,XNa
     >       /QCDTWO/Xnx,Xny,Xnz,XC3

      XNc2 = XNc**2

C u type: I = 1
C d type: I = 2


      PSI = 0D0
C IHELE = 1 -> veL
C IHELE = 2 -> veR
      DO IHELE = 1,2

C 1, +-+-+

      C1 = C(IHELE,2,TYPE1)
      C2 = C(IHELE,2,TYPE2)

      CALL qQgA70PPPHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PPPHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PPPHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PPPHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70PPPHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PPPHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PPPHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PPPHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 2, +-+--

      C1 = C(IHELE,2,TYPE1)
      C2 = C(IHELE,2,TYPE2)

      CALL qQgA70PPMHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PPMHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PPMHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PPMHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70PPMHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PPMHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PPMHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PPMHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 3, +--++

      C1 = C(IHELE,2,TYPE1)
      C2 = C(IHELE,1,TYPE2)

      CALL qQgA70PMPHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MPPHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MPPHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PMPHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70PMPHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MPPHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MPPHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PMPHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 4, +--+-

      C1 = C(IHELE,2,TYPE1)
      C2 = C(IHELE,1,TYPE2)

      CALL qQgA70PMMHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MPMHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MPMHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PMMHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70PMMHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MPMHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MPMHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70PMMHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 5, -++-+

      C1 = C(IHELE,1,TYPE1)
      C2 = C(IHELE,2,TYPE2)

      CALL qQgA70MPPHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PMPHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PMPHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MPPHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70MPPHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PMPHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PMPHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MPPHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 6, -++--

      C1 = C(IHELE,1,TYPE1)
      C2 = C(IHELE,2,TYPE2)

      CALL qQgA70MPMHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PMMHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PMMHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MPMHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70MPMHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70PMMHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70PMMHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MPMHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 7, -+-++

      C1 = C(IHELE,1,TYPE1)
      C2 = C(IHELE,1,TYPE2)

      CALL qQgA70MMPHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MMPHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MMPHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MMPHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70MMPHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MMPHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MMPHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MMPHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

C 8, -+-+-

      C1 = C(IHELE,1,TYPE1)
      C2 = C(IHELE,1,TYPE2)

      CALL qQgA70MMMHe_A1(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MMMHe_A3(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MMMHe_A1(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MMMHe_A3(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M1b1234 = C1*TEMP1 + C2*TEMP2
      M1b3412 = C2*TEMP3 + C1*TEMP4

      CALL qQgA70MMMHe_A2(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP1)
      CALL qQgA70MMMHe_A4(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP2)
      CALL qQgA70MMMHe_A2(THREE,FOUR,ONE,TWO,FIVE,SIX,SEVEN,IHELE,TEMP3)
      CALL qQgA70MMMHe_A4(ONE,TWO,THREE,FOUR,FIVE,SIX,SEVEN,IHELE,TEMP4)

      M2b1234 = C1*TEMP1 + C2*TEMP2
      M2b3412 = C2*TEMP3 + C1*TEMP4
      
      AA = M1b1234*CONJG(M1b1234) + M1b3412*CONJG(M1b3412) + M2b1234
     $     *CONJG(M2b1234) + M2b3412*CONJG(M2b3412)

      TEMP = M1b1234*CONJG(M2b1234) + M1b3412*CONJG(M2b3412)
      DD = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M1b3412) + M2b1234*CONJG(M2b3412)
      FF = TEMP + CONJG(TEMP)

      TEMP = M1b1234*CONJG(M2b3412) + M2b1234*CONJG(M1b3412)
      GG = TEMP + CONJG(TEMP)
      
      M_0 = 0d0
      M_x = 0d0
      M_y = AA + DD
      M_z = FF + GG
      M_xx = 0d0
      M_xy = -0.5D0*(FF + DD)

      PSI = PSI + M_0 + xnx*M_x + xny*M_y + xnz*M_z + xnx*xnx
     $     *M_xx+ xnx*xny*M_xy      

      ENDDO

c --- Color factor: Nc CF^3, 4 from explicit 2 in definition (A23) of NT

c --- Average is included over intial state spin states:
      M_2q2Q1g_tree = (XNc2-1D0)**3/XNc2*PSI

C---NORMALISATION OK, 4 PI ALPHA_EM = 4 PI ALPHA_S = 1

      END
